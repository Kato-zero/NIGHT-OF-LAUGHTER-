<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NIGHT OF LAUGHTER Upcoming Events | Buy Tickets</title>
    <link rel="icon" type="image/png" sizes="512x512" href="favicon.png">

    <!-- SEO Meta Tags -->
    <meta name="description" content="Night of Laughter is Zambia's premier comedy platform featuring top stand-up comedians like Chingliz, Ba Emma, Smoke, Juss, Rhema, and Bob Nkosha. Buy instant digital tickets for featured and upcoming comedy events in Lusaka and beyond.">
    <meta name="keywords" content="Night of Laughter, Zambia comedy event, stand-up comedy Zambia, ZED Laugh Festival, comedy shows Lusaka, Chingliz, Ba Emma, Smoke, Juss">
    <meta name="author" content="Night of Laughter Event Team">
    <style>
        :root {
            --blue: #007bff;
            --deep-blue: #1176d6;
            --gray-bg: #f2f2f2;
            --white: #fff;
            --black: #333;
            --offwhite: #f9f9f9;
            --card-shadow: 0 4px 10px rgba(0,0,0,.11);
        }
        html, body {
            margin: 0;
            padding: 0;
            font-family: system-ui, Arial, sans-serif;
            background: var(--gray-bg);
            color: var(--black);
        }
        header{
            width: 100%;
            background: var(--white);
            padding: 15px 5vw;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            position: fixed;
            top:0; left:0; z-index: 100;
        }
        .header-left { display: flex; align-items: center; }
        .header-logo { height: 105px; width: auto; }
        nav {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        nav a {
            padding: 8px 16px;
            color: var(--black);
            font-weight: 600;
            font-size: 12px;
            text-decoration: none;
            border-radius: 8px;
            transition: background .12s, color .14s;
        }
        nav a:hover, nav a:focus {
            background: #eaeaea;
            color: var(--blue);
        }
        .hero{ 
            width: 100%; height: 60vh; min-height: 290px;
            background: url('https://i.postimg.cc/28FNfrwW/1764496645079.jpg') center/cover no-repeat;
            display: flex; justify-content: center; align-items: center; text-align: center;
            padding: 0 7vw; margin-top: 65px;
        }
        .hero h1{ color: var(--white); font-size: 2.5rem; margin-bottom: 10px; text-shadow: 0 2px 10px rgba(0,0,0,.3);}
        .hero p{ color: #eee; font-size: 1.15rem; margin-bottom: 18px; text-shadow: 0 2px 6px rgba(0,0,0,0.4);}
        .featured, .events, #testimonialsSection, #contactSection { width: 100%; padding: 2rem 5vw 0 5vw; box-sizing: border-box; }

        .featured h2, .events h2, #testimonialsSection h2, #contactSection h2 {
            font-size: 1.6rem; margin-bottom: 20px;
        }
        .event-list { display: flex; flex-wrap: wrap; gap: 2vw; justify-content: center; }

        .event-card {
            width: 100%;
            max-width: 370px;
            background: var(--white);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
            margin: 36px 0;
            display: flex;
            flex-direction: column;
            transition: box-shadow .13s;
        }
        .event-card:hover { box-shadow: 0 4px 16px rgba(17,118,214,0.11);}
        .event-thumb {
            width: 100%;
            aspect-ratio: 1 / 1;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #ebebeb;
        }
        .event-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        .event-content {
            padding: 15px;
            flex: 1;
            line-height: 1.6;
            display: flex; flex-direction: column; justify-content: flex-start;
        }
        .event-title{
            font-size: 1.2rem; font-weight: bold; margin-bottom: 6px;
        }
        .info-label{ font-weight: bold;}
        .price-box {
            margin-top: 8px;
            padding: 10px;
            background: var(--offwhite);
            border-radius: 8px;
            font-size: 0.97em;
        }
        .btn-row{
            display: flex; flex-wrap: wrap; justify-content: space-between; align-items:center; margin-top: 14px; gap:12px;
        }
        .btn {
            flex: 1 1 46%;
            padding: 11px 0;
            background: var(--blue);
            color: var(--white);
            text-align: center;
            border-radius: 6px;
            text-decoration: none;
            font-weight: bold;
            cursor: pointer;
            border: none;
            transition: background .11s, opacity .11s;
            font-size: 1rem;
            min-width: 120px;
        }
        .btn.info{ background: #444; }
        .btn:hover, .btn:focus { opacity:0.93;}

        #testimonialsSection, #contactSection {
            padding: 2rem 5vw;
            background: var(--white);
            margin-top: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.04);
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            justify-content: center; align-items: center;
            z-index: 3000;
            overflow: auto;
        }
        .modal-content {
            background: var(--white);
            padding: 25px;
            width: 95vw; max-width: 500px;
            border-radius: 15px;
            position: relative;
            box-shadow: 0 9px 32px rgba(0,0,0,0.3);
            max-height: 90vh;
            overflow-y: auto;
        }
        .close {
            position: absolute;
            top: 15px; right: 20px;
            color: #444; font-size: 2.2rem; font-weight: bold; cursor: pointer;
        }
        .modal-step {
            display: none;
        }
        .modal-step.active {
            display: block;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            box-sizing: border-box;
        }
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--blue);
            box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
        }
        .modal-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        .modal-nav button {
            padding: 12px 24px;
            border-radius: 8px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            font-size: 16px;
        }
        .btn-prev {
            background: #f0f0f0;
            color: #333;
        }
        .btn-next {
            background: var(--blue);
            color: white;
        }
        .btn-pay {
            background: #28a745;
            color: white;
            width: 100%;
        }
        
        /* Confirmation Step */
        .confirmation-details {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .confirmation-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        .confirmation-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        .confirmation-label {
            font-weight: bold;
            color: #555;
        }
        .confirmation-value {
            color: #333;
            font-weight: 500;
        }
        
        /* Ticket Template */
        .ticket-template {
            background: white;
            border: 2px solid #333;
            border-radius: 10px;
            padding: 20px;
            max-width: 400px;
            margin: 0 auto;
            position: relative;
        }
        .ticket-header {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 2px dashed #333;
            padding-bottom: 15px;
        }
        .ticket-header h2 {
            color: var(--deep-blue);
            margin: 0 0 10px 0;
        }
        .ticket-body {
            margin-bottom: 20px;
        }
        .ticket-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding: 8px 0;
            border-bottom: 1px dashed #ddd;
        }
        .ticket-row:last-child {
            border-bottom: none;
        }
        .ticket-label {
            font-weight: bold;
            color: #555;
        }
        .ticket-value {
            color: #333;
        }
        .ticket-qr {
            text-align: center;
            margin: 20px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .ticket-footer {
            text-align: center;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 2px dashed #333;
            color: #666;
            font-size: 14px;
        }
        
        /* Loader */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--blue);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Admin Panel */
        .admin-panel {
            display: none;
            position: fixed;
            top: 70px;
            right: 20px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            z-index: 2000;
            max-width: 300px;
        }
        .admin-toggle {
            position: fixed;
            top: 70px;
            right: 20px;
            background: var(--blue);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 2001;
            font-weight: bold;
        }
        
        /* Payment Status Styles */
        .payment-status {
            padding: 20px;
            text-align: center;
            margin: 20px 0;
            border-radius: 10px;
        }
        .payment-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .payment-failed {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        footer{
            background: #222;
            padding: 20px 7vw;
            color: #ccc;
            text-align: center;
            margin-top: 50px;
            font-size: 0.95em;
        }

        /* Responsive */
        @media screen and (max-width: 600px) {
            header { flex-direction: column; align-items: flex-start; padding: 12px 3vw; }
            .header-logo { height: 42px;}
            nav { margin-top: 10px; gap: 4px;}
            .hero {
                min-height: 170px; height: 40vh; padding: 0 2vw;margin-top: 52px;
            }
            .hero h1{ font-size:1.37rem;}
            .hero p{ font-size: 1rem;}
            .event-card{ max-width:98vw; margin:24px 0;}
            .modal-content{ max-width:95vw; padding: 20px 15px;}
            .admin-toggle { top: 120px; right: 10px; }
        }
    </style>
    <!-- QR Code library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body>
    <!-- Admin Panel Toggle -->
    <button class="admin-toggle" onclick="toggleAdminPanel()">‚öôÔ∏è</button>
    
    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <h3 style="margin-top: 0; margin-bottom: 15px;">Event Management</h3>
        <div style="margin-bottom: 15px;">
            <button class="btn" onclick="refreshEvents()" style="width: 100%; margin-bottom: 10px;">
                üîÑ Refresh Events
            </button>
            <button class="btn" onclick="openAddEventForm()" style="width: 100%; background: #28a745;">
                ‚ûï Add New Event
            </button>
        </div>
        <div style="font-size: 12px; color: #666;">
            <p><strong>Current API URL:</strong></p>
            <input type="text" id="apiUrl" style="width: 100%; padding: 5px; font-size: 11px; margin-bottom: 10px;" 
                   value="https://sheetdb.io/api/v1/YOUR_API_ID_HERE" readonly>
            <button onclick="copyApiUrl()" style="width: 100%; padding: 8px; background: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer;">
                Copy API URL
            </button>
        </div>
    </div>

    <header>
        <div class="header-left">
            <img src="logo.png" alt="Night of Laughter Logo" class="header-logo" loading="lazy">
        </div>
        <nav id="navMenu">
            <a href="#featuredSection">Featured Events</a>
            <a href="#eventsSection">Upcoming Events</a>
            <a href="#testimonialsSection">Testimonials</a>
            <a href="#contactSection">Contact</a>
        </nav>
    </header>
    
    <!-- Payment Status Banner -->
    <div id="paymentStatusBanner" style="display: none; margin-top: 70px;"></div>
    
    <section class="hero">
        <div>
            <h1>NIGHT OF LAUGHTER</h1>
            <p>Instant digital tickets. No queues. No stress.</p>
        </div>
    </section>
    
    <!-- Loading State -->
    <section class="featured" id="featuredSection">
        <div class="loader" id="featuredLoader"></div>
    </section>
    <section class="events" id="eventsSection">
        <div class="loader" id="eventsLoader"></div>
    </section>
    
    <!-- About Section -->
    <section id="about" style="padding: 4rem 1.5rem; background: #f9f9f9;">
      <div style="max-width: 900px; margin: 0 auto; text-align: center;">
        <h1 style="font-size: 2.25rem; font-weight: bold; margin-bottom: 1.5rem; color: #333;">About Night of Laughter</h1>
        <p style="font-size: 1.125rem; color: #555; margin-bottom: 1rem;">
          Night of Laughter is Zambia's premier comedy platform, showcasing the country's top stand-up comedians, content creators, and writers.
        </p>
        <!-- About Section for Night of Laughter -->
<section id="about" style="padding: 4rem 5vw; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);">
    <div style="max-width: 1200px; margin: 0 auto;">
        <div style="text-align: center; margin-bottom: 3rem;">
            <h1 style="font-size: 2.5rem; font-weight: bold; margin-bottom: 1rem; color: #1176d6; position: relative; display: inline-block;">
                <span style="position: relative; z-index: 2;">About Night of Laughter</span>
                <span style="position: absolute; bottom: 5px; left: 0; width: 100%; height: 8px; background: rgba(17, 118, 214, 0.2); z-index: 1;"></span>
            </h1>
            <p style="font-size: 1.2rem; color: #555; max-width: 800px; margin: 0 auto;">
                Zambia's Premier Comedy Platform - Where Laughter Meets Excellence
            </p>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; margin-bottom: 3rem;">
            <div>
                <h2 style="font-size: 1.8rem; color: #333; margin-bottom: 1.5rem; border-left: 4px solid #1176d6; padding-left: 15px;">
                    Our Story
                </h2>
                <p style="font-size: 1.1rem; color: #555; line-height: 1.8; margin-bottom: 1.5rem;">
                    Founded in 2022, <strong>Night of Laughter</strong> emerged as Zambia's first professional comedy platform dedicated to showcasing the nation's top comedic talent. What began as a small gathering of comedy enthusiasts has evolved into the country's leading comedy production company.
                </p>
                <p style="font-size: 1.1rem; color: #555; line-height: 1.8; margin-bottom: 1.5rem;">
                    Our mission is simple: to create unforgettable comedy experiences, nurture local talent, and bring world-class humor to audiences across Zambia and beyond. We believe laughter is universal, and through our events, we're building a community that celebrates comedy as an art form.
                </p>
            </div>

            <div>
                <h2 style="font-size: 1.8rem; color: #333; margin-bottom: 1.5rem; border-left: 4px solid #1176d6; padding-left: 15px;">
                    What We Do
                </h2>
                <div style="background: white; padding: 1.5rem; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                    <div style="display: flex; align-items: start; margin-bottom: 1rem;">
                        <div style="background: #1176d6; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px; flex-shrink: 0;">
                            <span style="font-weight: bold;">‚úì</span>
                        </div>
                        <div>
                            <h3 style="margin: 0 0 5px 0; color: #333;">Comedy Events & Festivals</h3>
                            <p style="margin: 0; color: #666; font-size: 0.95rem;">Producing large-scale comedy shows featuring top Zambian and international comedians</p>
                        </div>
                    </div>
                    <div style="display: flex; align-items: start; margin-bottom: 1rem;">
                        <div style="background: #1176d6; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px; flex-shrink: 0;">
                            <span style="font-weight: bold;">‚úì</span>
                        </div>
                        <div>
                            <h3 style="margin: 0 0 5px 0; color: #333;">Talent Development</h3>
                            <p style="margin: 0; color: #666; font-size: 0.95rem;">Nurturing emerging comedians through workshops and open mic nights</p>
                        </div>
                    </div>
                    <div style="display: flex; align-items: start;">
                        <div style="background: #1176d6; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px; flex-shrink: 0;">
                            <span style="font-weight: bold;">‚úì</span>
                        </div>
                        <div>
                            <h3 style="margin: 0 0 5px 0; color: #333;">Digital Ticketing</h3>
                            <p style="margin: 0; color: #666; font-size: 0.95rem;">Providing seamless, instant digital ticket experiences for comedy fans</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div style="margin-bottom: 3rem;">
            <h2 style="font-size: 1.8rem; color: #333; margin-bottom: 1.5rem; text-align: center;">
                Milestone Events
            </h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
                <div style="background: white; padding: 1.5rem; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); text-align: center;">
                    <div style="font-size: 2.5rem; color: #1176d6; margin-bottom: 0.5rem;">üé≠</div>
                    <h3 style="margin: 0 0 10px 0; color: #333;">ZED Laugh Festival 2025</h3>
                    <p style="color: #666; margin: 0; font-size: 0.95rem;">Zambia's largest comedy festival featuring 20+ comedians</p>
                </div>
                <div style="background: white; padding: 1.5rem; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); text-align: center;">
                    <div style="font-size: 2.5rem; color: #1176d6; margin-bottom: 0.5rem;">üåü</div>
                    <h3 style="margin: 0 0 10px 0; color: #333;">Comedy Night Special 2024</h3>
                    <p style="color: #666; margin: 0; font-size: 0.95rem;">Sold-out show featuring Zambia's comedy legends</p>
                </div>
                <div style="background: white; padding: 1.5rem; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); text-align: center;">
                    <div style="font-size: 2.5rem; color: #1176d6; margin-bottom: 0.5rem;">üöÄ</div>
                    <h3 style="margin: 0 0 10px 0; color: #333;">Regional Tour 2023</h3>
                    <p style="color: #666; margin: 0; font-size: 0.95rem;">Successful tour across 5 Zambian cities</p>
                </div>
                <div style="background: white; padding: 1.5rem; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); text-align: center;">
                    <div style="font-size: 2.5rem; color: #1176d6; margin-bottom: 0.5rem;">üèÜ</div>
                    <h3 style="margin: 0 0 10px 0; color: #333;">Stand-Up Showcase 2023</h3>
                    <p style="color: #666; margin: 0; font-size: 0.95rem;">Launchpad for emerging comedy talent</p>
                </div>
            </div>
        </div>

        <div style="margin-bottom: 3rem;">
            <h2 style="font-size: 1.8rem; color: #333; margin-bottom: 1.5rem; text-align: center;">
                Featured Comedians
            </h2>
            <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem; margin-bottom: 2rem;">
                <div style="background: white; padding: 1rem 1.5rem; border-radius: 25px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%;"></div>
                    <span style="font-weight: bold; color: #333;">Chingliz</span>
                </div>
                <div style="background: white; padding: 1rem 1.5rem; border-radius: 25px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 50%;"></div>
                    <span style="font-weight: bold; color: #333;">Ba Emma</span>
                </div>
                <div style="background: white; padding: 1rem 1.5rem; border-radius: 25px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: 50%;"></div>
                    <span style="font-weight: bold; color: #333;">Smoke</span>
                </div>
                <div style="background: white; padding: 1rem 1.5rem; border-radius: 25px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); border-radius: 50%;"></div>
                    <span style="font-weight: bold; color: #333;">Juss</span>
                </div>
                <div style="background: white; padding: 1rem 1.5rem; border-radius: 25px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); border-radius: 50%;"></div>
                    <span style="font-weight: bold; color: #333;">Rhema</span>
                </div>
                <div style="background: white; padding: 1rem 1.5rem; border-radius: 25px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); display: flex; align-items: center; gap: 10px;">
                    <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); border-radius: 50%;"></div>
                    <span style="font-weight: bold; color: #333;">Bob Nkosha</span>
                </div>
            </div>
            <p style="text-align: center; color: #666; font-size: 1.1rem; max-width: 800px; margin: 0 auto; line-height: 1.7;">
                Night of Laughter has proudly featured Zambia's top comedic talents while welcoming renowned regional performers from across Africa. Our platform continues to celebrate Zambia's rich comedy scene and provide opportunities for both established and emerging performers.
            </p>
        </div>

        <div style="background: linear-gradient(135deg, #1176d6 0%, #0d5bb5 100%); padding: 2.5rem; border-radius: 15px; color: white; text-align: center;">
            <h2 style="font-size: 1.8rem; margin-bottom: 1rem;">Join the Laughter Revolution</h2>
            <p style="font-size: 1.1rem; margin-bottom: 1.5rem; opacity: 0.9;">
                Experience the best of Zambian comedy. Whether you're looking for a night of laughs or want to perform on our stage, Night of Laughter is your premier destination.
            </p>
            <div style="display: flex; gap: 1rem; justify-content: center;">
                <a href="#eventsSection" style="background: white; color: #1176d6; padding: 0.8rem 2rem; border-radius: 8px; text-decoration: none; font-weight: bold; transition: transform 0.3s;">
                    View Events
                </a>
                <a href="#contactSection" style="background: transparent; border: 2px solid white; color: white; padding: 0.8rem 2rem; border-radius: 8px; text-decoration: none; font-weight: bold; transition: background 0.3s;">
                    Contact Us
                </a>
            </div>
        </div>
    </div>
</section>
          
    <section id="testimonialsSection">
        <h2>Testimonials</h2>
        <!-- Testimonials Section with Slideshow -->
<section id="testimonialsSection" style="padding: 5rem 5vw; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);">
    <div style="max-width: 1200px; margin: 0 auto;">
        <div style="text-align: center; margin-bottom: 3rem;">
            <h2 style="font-size: 2.2rem; font-weight: bold; margin-bottom: 1rem; color: #1176d6; position: relative; display: inline-block;">
                <span style="position: relative; z-index: 2;">What Our Audience Says</span>
                <span style="position: absolute; bottom: 5px; left: 0; width: 100%; height: 8px; background: rgba(17, 118, 214, 0.2); z-index: 1;"></span>
            </h2>
            <p style="font-size: 1.1rem; color: #666; max-width: 600px; margin: 0 auto;">
                Hear from comedy lovers who've experienced the magic of Night of Laughter
            </p>
        </div>

        <!-- Testimonials Slideshow Container -->
        <div style="position: relative; max-width: 900px; margin: 0 auto;">
            <!-- Testimonial Cards Container -->
            <div id="testimonialsContainer" style="display: flex; overflow: hidden; border-radius: 15px; position: relative; min-height: 350px; background: white; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
                
                <!-- Testimonial 1 -->
                <div class="testimonial-card" style="min-width: 100%; padding: 3rem; display: flex; flex-direction: column; justify-content: center; transition: transform 0.5s ease;">
                    <div style="display: flex; align-items: center; margin-bottom: 2rem;">
                        <div style="width: 70px; height: 70px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%; margin-right: 1.5rem; flex-shrink: 0;"></div>
                        <div>
                            <h3 style="margin: 0 0 5px 0; color: #333; font-size: 1.3rem;">Sarah Mwale</h3>
                            <p style="margin: 0; color: #666; font-size: 0.9rem;">Regular Attendee ‚Ä¢ Lusaka</p>
                            <div style="display: flex; margin-top: 5px;">
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                            </div>
                        </div>
                    </div>
                    <p style="font-size: 1.1rem; line-height: 1.7; color: #555; font-style: italic; margin: 0; position: relative; padding-left: 1.5rem;">
                        <span style="position: absolute; left: 0; top: -10px; color: #1176d6; font-size: 2rem; font-family: Georgia, serif;">"</span>
                        Night of Laughter has completely transformed the comedy scene in Zambia! The ZED Laugh Festival was the funniest night I've had all year. The lineup was incredible, and the digital ticketing made everything so easy. Can't wait for the next one!
                    </p>
                    <p style="margin-top: 1rem; color: #888; font-size: 0.9rem;">
                        Attended: ZED Laugh Festival 2025
                    </p>
                </div>

                <!-- Testimonial 2 -->
                <div class="testimonial-card" style="min-width: 100%; padding: 3rem; display: flex; flex-direction: column; justify-content: center; transition: transform 0.5s ease;">
                    <div style="display: flex; align-items: center; margin-bottom: 2rem;">
                        <div style="width: 70px; height: 70px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 50%; margin-right: 1.5rem; flex-shrink: 0;"></div>
                        <div>
                            <h3 style="margin: 0 0 5px 0; color: #333; font-size: 1.3rem;">John Banda</h3>
                            <p style="margin: 0; color: #666; font-size: 0.9rem;">First-time Attendee ‚Ä¢ Kitwe</p>
                            <div style="display: flex; margin-top: 5px;">
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                            </div>
                        </div>
                    </div>
                    <p style="font-size: 1.1rem; line-height: 1.7; color: #555; font-style: italic; margin: 0; position: relative; padding-left: 1.5rem;">
                        <span style="position: absolute; left: 0; top: -10px; color: #1176d6; font-size: 2rem; font-family: Georgia, serif;">"</span>
                        I was skeptical about buying tickets online, but the process was seamless! The instant digital tickets saved me from queuing. The comedy show itself was top-notch - Chingliz had us in stitches all night. Will definitely be coming back!
                    </p>
                    <p style="margin-top: 1rem; color: #888; font-size: 0.9rem;">
                        Attended: Comedy Night Special 2024
                    </p>
                </div>

                <!-- Testimonial 3 -->
                <div class="testimonial-card" style="min-width: 100%; padding: 3rem; display: flex; flex-direction: column; justify-content: center; transition: transform 0.5s ease;">
                    <div style="display: flex; align-items: center; margin-bottom: 2rem;">
                        <div style="width: 70px; height: 70px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: 50%; margin-right: 1.5rem; flex-shrink: 0;"></div>
                        <div>
                            <h3 style="margin: 0 0 5px 0; color: #333; font-size: 1.3rem;">Emily Kapumba</h3>
                            <p style="margin: 0; color: #666; font-size: 0.9rem;">Corporate Client ‚Ä¢ Ndola</p>
                            <div style="display: flex; margin-top: 5px;">
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                            </div>
                        </div>
                    </div>
                    <p style="font-size: 1.1rem; line-height: 1.7; color: #555; font-style: italic; margin: 0; position: relative; padding-left: 1.5rem;">
                        <span style="position: absolute; left: 0; top: -10px; color: #1176d6; font-size: 2rem; font-family: Georgia, serif;">"</span>
                        We booked Night of Laughter for our company year-end party, and it was the best decision ever! The comedians were professional, the content was appropriate for our diverse team, and everyone had an amazing time. Highly recommended for corporate events!
                    </p>
                    <p style="margin-top: 1rem; color: #888; font-size: 0.9rem;">
                        Attended: Corporate Comedy Night
                    </p>
                </div>

                <!-- Testimonial 4 -->
                <div class="testimonial-card" style="min-width: 100%; padding: 3rem; display: flex; flex-direction: column; justify-content: center; transition: transform 0.5s ease;">
                    <div style="display: flex; align-items: center; margin-bottom: 2rem;">
                        <div style="width: 70px; height: 70px; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); border-radius: 50%; margin-right: 1.5rem; flex-shrink: 0;"></div>
                        <div>
                            <h3 style="margin: 0 0 5px 0; color: #333; font-size: 1.3rem;">Charity Musonda</h3>
                            <p style="margin: 0; color: #666; font-size: 0.9rem;">Comedy Enthusiast ‚Ä¢ Livingstone</p>
                            <div style="display: flex; margin-top: 5px;">
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                            </div>
                        </div>
                    </div>
                    <p style="font-size: 1.1rem; line-height: 1.7; color: #555; font-style: italic; margin: 0; position: relative; padding-left: 1.5rem;">
                        <span style="position: absolute; left: 0; top: -10px; color: #1176d6; font-size: 2rem; font-family: Georgia, serif;">"</span>
                       Laughter is therapeutic....fun was had. Looking forward to the next show. </p>
                    <p style="margin-top: 1rem; color: #888; font-size: 0.9rem;">
                        Attended: Regional Tour 2023
                    </p>
                </div>

                <!-- Testimonial 5 -->
                <div class="testimonial-card" style="min-width: 100%; padding: 3rem; display: flex; flex-direction: column; justify-content: center; transition: transform 0.5s ease;">
                    <div style="display: flex; align-items: center; margin-bottom: 2rem;">
                        <div style="width: 70px; height: 70px; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); border-radius: 50%; margin-right: 1.5rem; flex-shrink: 0;"></div>
                        <div>
                            <h3 style="margin: 0 0 5px 0; color: #333; font-size: 1.3rem;">Bobo</h3>
                            <p style="margin: 0; color: #666; font-size: 0.9rem;"></p>
                            <div style="display: flex; margin-top: 5px;">
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                                <span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>
                            </div>
                        </div>
                    </div>
                    <p style="font-size: 1.1rem; line-height: 1.7; color: #555; font-style: italic; margin: 0; position: relative; padding-left: 1.5rem;">
                        <span style="position: absolute; left: 0; top: -10px; color: #1176d6; font-size: 2rem; font-family: Georgia, serif;">"</span>
                       This was awesome, my woman and i had a greta time. thank you so much <a>NIGHT OF LAUGHTER</a> especially the guy from Botswana, i hope he see my comment!!üòÇüòÇ
                    </p>
                    <p style="margin-top: 1rem; color: #888; font-size: 0.9rem;">
                        Attended: Zed lsugh festival 2025
                    </p>
                </div>
            </div>

            <!-- Navigation Arrows -->
            <button id="prevBtn" style="position: absolute; left: 20px; top: 50%; transform: translateY(-50%); background: white; border: none; width: 50px; height: 50px; border-radius: 50%; box-shadow: 0 3px 10px rgba(0,0,0,0.2); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: #1176d6; z-index: 10; transition: all 0.3s;">
                ‚Äπ
            </button>
            <button id="nextBtn" style="position: absolute; right: 20px; top: 50%; transform: translateY(-50%); background: white; border: none; width: 50px; height: 50px; border-radius: 50%; box-shadow: 0 3px 10px rgba(0,0,0,0.2); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: #1176d6; z-index: 10; transition: all 0.3s;">
                ‚Ä∫
            </button>

            <!-- Dots Navigation -->
            <div style="display: flex; justify-content: center; gap: 10px; margin-top: 2rem;">
                <button class="dot" data-index="0" style="width: 12px; height: 12px; border-radius: 50%; border: none; background: #ddd; cursor: pointer; transition: background 0.3s;"></button>
                <button class="dot" data-index="1" style="width: 12px; height: 12px; border-radius: 50%; border: none; background: #ddd; cursor: pointer; transition: background 0.3s;"></button>
                <button class="dot" data-index="2" style="width: 12px; height: 12px; border-radius: 50%; border: none; background: #ddd; cursor: pointer; transition: background 0.3s;"></button>
                <button class="dot" data-index="3" style="width: 12px; height: 12px; border-radius: 50%; border: none; background: #ddd; cursor: pointer; transition: background 0.3s;"></button>
                <button class="dot" data-index="4" style="width: 12px; height: 12px; border-radius: 50%; border: none; background: #ddd; cursor: pointer; transition: background 0.3s;"></button>
            </div>
        </div>

        <!-- Add Your Testimonial CTA -->
        <div style="text-align: center; margin-top: 3rem;">
            <div style="background: #f0f7ff; padding: 2rem; border-radius: 10px; max-width: 600px; margin: 0 auto;">
                <h3 style="color: #333; margin-bottom: 1rem;">Share Your Experience</h3>
                <p style="color: #666; margin-bottom: 1.5rem;">
                    Attended a Night of Laughter event? We'd love to hear from you!
                </p>
                <button id="addTestimonialBtn" style="background: #1176d6; color: white; border: none; padding: 0.8rem 2rem; border-radius: 8px; font-weight: bold; cursor: pointer; transition: background 0.3s;">
                    Submit Your Testimonial
                </button>
            </div>
        </div>
    </div>
</section>

<!-- Add Testimonial Modal -->
<div id="testimonialModal" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 500px;">
        <span class="close" onclick="closeTestimonialModal()">&times;</span>
        <h2 style="color: #1176d6; margin-bottom: 1rem;">Share Your Experience</h2>
        <p style="color: #666; margin-bottom: 1.5rem;">
            Tell us about your Night of Laughter experience. Selected testimonials may be featured on our website!
        </p>
        
        <form id="testimonialForm" style="display: flex; flex-direction: column; gap: 1rem;">
            <div>
                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold; color: #333;">Your Name</label>
                <input type="text" id="testimonialName" placeholder="Enter your name" style="width: 100%; padding: 0.8rem; border: 1px solid #ddd; border-radius: 5px; font-size: 1rem;" required>
            </div>
            
            <div>
                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold; color: #333;">Email Address</label>
                <input type="email" id="testimonialEmail" placeholder="Enter your email" style="width: 100%; padding: 0.8rem; border: 1px solid #ddd; border-radius: 5px; font-size: 1rem;" required>
            </div>
            
            <div>
                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold; color: #333;">Event Attended</label>
                <select id="testimonialEvent" style="width: 100%; padding: 0.8rem; border: 1px solid #ddd; border-radius: 5px; font-size: 1rem;" required>
                    <option value="">Select Event</option>
                    <option value="ZED Laugh Festival 2025">ZED Laugh Festival 2025</option>
                    <option value="Comedy Night Special 2024">Comedy Night Special 2024</option>
                    <option value="Regional Tour 2023">Regional Tour 2023</option>
                    <option value="Stand-Up Showcase 2023">Stand-Up Showcase 2023</option>
                    <option value="Other">Other Event</option>
                </select>
            </div>
            
            <div>
                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold; color: #333;">Your Rating</label>
                <div style="display: flex; gap: 5px; margin-bottom: 0.5rem;">
                    <span class="rating-star" data-rating="1" style="font-size: 1.5rem; cursor: pointer; color: #ddd;">‚òÖ</span>
                    <span class="rating-star" data-rating="2" style="font-size: 1.5rem; cursor: pointer; color: #ddd;">‚òÖ</span>
                    <span class="rating-star" data-rating="3" style="font-size: 1.5rem; cursor: pointer; color: #ddd;">‚òÖ</span>
                    <span class="rating-star" data-rating="4" style="font-size: 1.5rem; cursor: pointer; color: #ddd;">‚òÖ</span>
                    <span class="rating-star" data-rating="5" style="font-size: 1.5rem; cursor: pointer; color: #ddd;">‚òÖ</span>
                </div>
                <input type="hidden" id="testimonialRating" value="5" required>
            </div>
            
            <div>
                <label style="display: block; margin-bottom: 0.5rem; font-weight: bold; color: #333;">Your Testimonial</label>
                <textarea id="testimonialText" placeholder="Share your experience..." rows="5" style="width: 100%; padding: 0.8rem; border: 1px solid #ddd; border-radius: 5px; font-size: 1rem; resize: vertical;" required></textarea>
            </div>
            
            <button type="submit" style="background: #1176d6; color: white; border: none; padding: 1rem; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 1rem; margin-top: 1rem;">
                Submit Testimonial
            </button>
        </form>
    </div>
</div>

<style>
    /* Hover effects for buttons */
    #prevBtn:hover, #nextBtn:hover {
        background: #1176d6;
        color: white;
        transform: translateY(-50%) scale(1.1);
    }
    
    .dot.active {
        background: #1176d6 !important;
        transform: scale(1.2);
    }
    
    .rating-star.selected {
        color: #FFD700 !important;
    }
    
    #addTestimonialBtn:hover {
        background: #0d5bb5;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
        #testimonialsContainer {
            min-height: 400px;
        }
        
        .testimonial-card {
            padding: 2rem !important;
        }
        
        #prevBtn, #nextBtn {
            width: 40px;
            height: 40px;
            font-size: 1.2rem;
        }
        
        #prevBtn {
            left: 10px;
        }
        
        #nextBtn {
            right: 10px;
        }
    }
    
    @media (max-width: 480px) {
        .testimonial-card {
            padding: 1.5rem !important;
        }
        
        #testimonialsContainer {
            min-height: 450px;
        }
    }
</style>

<script>
    // Testimonials Slideshow JavaScript
    document.addEventListener('DOMContentLoaded', function() {
        const testimonialsContainer = document.getElementById('testimonialsContainer');
        const testimonialCards = document.querySelectorAll('.testimonial-card');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const dots = document.querySelectorAll('.dot');
        const addTestimonialBtn = document.getElementById('addTestimonialBtn');
        const testimonialModal = document.getElementById('testimonialModal');
        const ratingStars = document.querySelectorAll('.rating-star');
        const testimonialRating = document.getElementById('testimonialRating');
        const testimonialForm = document.getElementById('testimonialForm');
        
        let currentIndex = 0;
        const totalTestimonials = testimonialCards.length;
        
        // Initialize dots
        dots[0].classList.add('active');
        
        // Function to update slideshow
        function updateTestimonial() {
            // Move container to show current testimonial
            testimonialsContainer.style.transform = `translateX(-${currentIndex * 100}%)`;
            
            // Update dots
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentIndex);
            });
        }
        
        // Next button click
        nextBtn.addEventListener('click', function() {
            currentIndex = (currentIndex + 1) % totalTestimonials;
            updateTestimonial();
        });
        
        // Previous button click
        prevBtn.addEventListener('click', function() {
            currentIndex = (currentIndex - 1 + totalTestimonials) % totalTestimonials;
            updateTestimonial();
        });
        
        // Dot navigation
        dots.forEach((dot, index) => {
            dot.addEventListener('click', function() {
                currentIndex = index;
                updateTestimonial();
            });
        });
        
        // Auto-advance slideshow every 8 seconds
        let slideInterval = setInterval(() => {
            currentIndex = (currentIndex + 1) % totalTestimonials;
            updateTestimonial();
        }, 8000);
        
        // Pause auto-advance on hover
        testimonialsContainer.addEventListener('mouseenter', function() {
            clearInterval(slideInterval);
        });
        
        testimonialsContainer.addEventListener('mouseleave', function() {
            slideInterval = setInterval(() => {
                currentIndex = (currentIndex + 1) % totalTestimonials;
                updateTestimonial();
            }, 8000);
        });
        
        // Testimonial Modal Functions
        addTestimonialBtn.addEventListener('click', function() {
            testimonialModal.style.display = 'flex';
        });
        
        function closeTestimonialModal() {
            testimonialModal.style.display = 'none';
            testimonialForm.reset();
            // Reset stars to default
            ratingStars.forEach(star => star.classList.remove('selected'));
            ratingStars[4].classList.add('selected');
            testimonialRating.value = '5';
        }
        
        // Rating stars interaction
        ratingStars.forEach(star => {
            star.addEventListener('click', function() {
                const rating = parseInt(this.getAttribute('data-rating'));
                
                // Update stars display
                ratingStars.forEach((s, index) => {
                    if (index < rating) {
                        s.classList.add('selected');
                    } else {
                        s.classList.remove('selected');
                    }
                });
                
                // Update hidden input value
                testimonialRating.value = rating;
            });
        });
        
        // Initialize with 5 stars selected
        ratingStars[4].classList.add('selected');
        
        // Form submission
        testimonialForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const name = document.getElementById('testimonialName').value;
            const email = document.getElementById('testimonialEmail').value;
            const event = document.getElementById('testimonialEvent').value;
            const rating = testimonialRating.value;
            const text = document.getElementById('testimonialText').value;
            
            // In a real application, you would send this data to your server
            // For now, we'll just show a success message
            
            alert(`Thank you, ${name}! Your testimonial has been submitted.\n\nWe appreciate your feedback and may feature it on our website after review.`);
            
            // Close modal and reset form
            closeTestimonialModal();
            
            // You could also add the testimonial to the slideshow dynamically
            // addTestimonialToSlideshow({name, email, event, rating, text});
        });
        
        // Close modal when clicking outside
        window.addEventListener('click', function(e) {
            if (e.target === testimonialModal) {
                closeTestimonialModal();
            }
        });
        
        // Function to dynamically add testimonials (for future use)
        function addTestimonialToSlideshow(testimonialData) {
            // This function would create a new testimonial card
            // and add it to the slideshow
            console.log('New testimonial:', testimonialData);
            
            // Example of how you could implement this:
            /*
            const newCard = document.createElement('div');
            newCard.className = 'testimonial-card';
            newCard.style.minWidth = '100%';
            newCard.style.padding = '3rem';
            newCard.style.display = 'flex';
            newCard.style.flexDirection = 'column';
            newCard.style.justifyContent = 'center';
            newCard.style.transition = 'transform 0.5s ease';
            
            newCard.innerHTML = `
                <div style="display: flex; align-items: center; margin-bottom: 2rem;">
                    <div style="width: 70px; height: 70px; background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); border-radius: 50%; margin-right: 1.5rem; flex-shrink: 0;"></div>
                    <div>
                        <h3 style="margin: 0 0 5px 0; color: #333; font-size: 1.3rem;">${testimonialData.name}</h3>
                        <p style="margin: 0; color: #666; font-size: 0.9rem;">Attendee ‚Ä¢ ${testimonialData.event}</p>
                        <div style="display: flex; margin-top: 5px;">
                            ${'<span style="color: #FFD700; font-size: 1.2rem;">‚òÖ</span>'.repeat(testimonialData.rating)}
                        </div>
                    </div>
                </div>
                <p style="font-size: 1.1rem; line-height: 1.7; color: #555; font-style: italic; margin: 0; position: relative; padding-left: 1.5rem;">
                    <span style="position: absolute; left: 0; top: -10px; color: #1176d6; font-size: 2rem; font-family: Georgia, serif;">"</span>
                    ${testimonialData.text}
                </p>
            `;
            
            testimonialsContainer.appendChild(newCard);
            
            // Add new dot
            const dotsContainer = document.querySelector('.dots-container');
            const newDot = document.createElement('button');
            newDot.className = 'dot';
            newDot.setAttribute('data-index', totalTestimonials);
            newDot.style.cssText = 'width: 12px; height: 12px; border-radius: 50%; border: none; background: #ddd; cursor: pointer; transition: background 0.3s;';
            dotsContainer.appendChild(newDot);
            
            // Update total count and reinitialize event listeners
            totalTestimonials++;
            */
        }
    });
</script>
    </section>
    <section id="contactSection">
        <h2>Contact</h2>
        <p>Email: info@nightoflaughter.com<br>Phone: +260-973299759</p>
    </section>
    
    <!-- Ticket Purchase Modal -->
    <div id="ticketModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            
            <!-- Step 1: Select Ticket Type -->
            <div id="step1" class="modal-step active">
                <h2>Select Ticket Type</h2>
                <p id="modalEventName" style="color: #666; margin-bottom: 20px;"></p>
                
                <div class="form-group">
                    <label for="ticketType">Choose your ticket:</label>
                    <select id="ticketType" class="ticket-select">
                        <option value="">-- Select Ticket Type --</option>
                        <option value="vip_single">VIP Single</option>
                        <option value="vip_double">VIP Double</option>
                        <option value="ordinary_single">Ordinary Single</option>
                        <option value="ordinary_double">Ordinary Double</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="ticketQuantity">Number of Tickets:</label>
                    <select id="ticketQuantity">
                        <option value="1">1 Ticket</option>
                        <option value="2">2 Tickets</option>
                        <option value="3">3 Tickets</option>
                        <option value="4">4 Tickets</option>
                        <option value="5">5 Tickets</option>
                    </select>
                </div>
                
                <div id="priceDisplay" style="background: #e8f5e9; padding: 15px; border-radius: 8px; margin: 20px 0; display: none;">
                    <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 1.2em;">
                        <span>Total Price:</span>
                        <span id="totalPrice">K0</span>
                    </div>
                </div>
                
                <div class="modal-nav">
                    <button class="btn-prev" disabled>Back</button>
                    <button class="btn-next" onclick="nextStep(1)">Continue</button>
                </div>
            </div>
            
            <!-- Step 2: Enter Personal Info -->
            <div id="step2" class="modal-step">
                <h2>Your Information</h2>
                <p style="color: #666; margin-bottom: 20px;">Please enter your details for the ticket</p>
                
                <div class="form-group">
                    <label for="fullName">Full Name:</label>
                    <input type="text" id="fullName" placeholder="Enter your full name" required>
                </div>
                
                <div class="form-group">
                    <label for="email">Email Address:</label>
                    <input type="email" id="email" placeholder="Enter your email" required>
                </div>
                
                <div class="form-group">
                    <label for="phone">Phone Number:</label>
                    <input type="tel" id="phone" placeholder="Enter your phone number" required>
                </div>
                
                <div class="modal-nav">
                    <button class="btn-prev" onclick="prevStep(2)">Back</button>
                    <button class="btn-next" onclick="nextStep(2)">Continue</button>
                </div>
            </div>
            
            <!-- Step 3: Confirmation -->
            <div id="step3" class="modal-step">
                <h2>Confirm Your Booking</h2>
                <p style="color: #666; margin-bottom: 20px;">Please review your information before proceeding to payment</p>
                
                <div class="confirmation-details">
                    <div class="confirmation-item">
                        <span class="confirmation-label">Event:</span>
                        <span class="confirmation-value" id="confirmEvent"></span>
                    </div>
                    <div class="confirmation-item">
                        <span class="confirmation-label">Ticket Type:</span>
                        <span class="confirmation-value" id="confirmTicketType"></span>
                    </div>
                    <div class="confirmation-item">
                        <span class="confirmation-label">Quantity:</span>
                        <span class="confirmation-value" id="confirmQuantity"></span>
                    </div>
                    <div class="confirmation-item">
                        <span class="confirmation-label">Total Price:</span>
                        <span class="confirmation-value" id="confirmPrice"></span>
                    </div>
                    <div class="confirmation-item">
                        <span class="confirmation-label">Name:</span>
                        <span class="confirmation-value" id="confirmName"></span>
                    </div>
                    <div class="confirmation-item">
                        <span class="confirmation-label">Email:</span>
                        <span class="confirmation-value" id="confirmEmail"></span>
                    </div>
                    <div class="confirmation-item">
                        <span class="confirmation-label">Phone:</span>
                        <span class="confirmation-value" id="confirmPhone"></span>
                    </div>
                </div>
                
                <div class="modal-nav">
                    <button class="btn-prev" onclick="prevStep(3)">Back</button>
                    <button class="btn-pay" onclick="proceedToPayment()">Proceed to Payment</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Success Modal -->
    <div id="successModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeSuccessModal()">&times;</span>
            
            <div style="text-align: center; padding: 20px;">
                <div style="color: #28a745; font-size: 48px; margin-bottom: 20px;">‚úì</div>
                <h2 style="color: #28a745;">Payment Successful!</h2>
                <p style="color: #666; margin: 20px 0;">Your ticket has been generated and is ready to download.</p>
                
                <div id="ticketContainer" style="margin: 30px 0;"></div>
                
                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 30px;">
                    <button class="btn" onclick="downloadTicket()" style="background: var(--blue);">
                        Download Ticket
                    </button>
                    <button class="btn" onclick="printTicket()" style="background: #17a2b8;">
                        Print Ticket
                    </button>
                    <button class="btn" onclick="closeSuccessModal()" style="background: #6c757d;">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Add Event Form Modal -->
    <div id="addEventModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeAddEventModal()">&times;</span>
            <h2>Add New Event</h2>
            <p style="color: #666; margin-bottom: 20px;">Fill in the event details below. This will add to your Google Sheet.</p>
            
            <form id="addEventForm">
                <div class="form-group">
                    <label for="eventName">Event Name *</label>
                    <input type="text" id="eventName" placeholder="ZED Laugh Festival 2025" required>
                </div>
                
                <div class="form-group">
                    <label for="eventType">Event Type *</label>
                    <select id="eventType" required>
                        <option value="">-- Select Type --</option>
                        <option value="featured">Featured</option>
                        <option value="upcoming">Upcoming</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="eventDate">Date *</label>
                    <input type="text" id="eventDate" placeholder="March 15, 2025" required>
                </div>
                
                <div class="form-group">
                    <label for="eventTime">Time *</label>
                    <input type="text" id="eventTime" placeholder="6:00 PM" required>
                </div>
                
                <div class="form-group">
                    <label for="eventVenue">Venue *</label>
                    <input type="text" id="eventVenue" placeholder="Lusaka Playhouse" required>
                </div>
                
                <div class="form-group">
                    <label for="eventImage">Image URL *</label>
                    <input type="url" id="eventImage" placeholder="https://example.com/image.jpg" required>
                </div>
                
                <div class="form-group">
                    <label for="eventDescription">Description *</label>
                    <input type="text" id="eventDescription" placeholder="Biggest comedy festival in Zambia" required>
                </div>
                
                <div class="form-group">
                    <label for="vipSingle">VIP Single Price (K)</label>
                    <input type="number" id="vipSingle" placeholder="500" required>
                </div>
                
                <div class="form-group">
                    <label for="vipDouble">VIP Double Price (K)</label>
                    <input type="number" id="vipDouble" placeholder="800" required>
                </div>
                
                <div class="form-group">
                    <label for="ordinarySingle">Ordinary Single Price (K)</label>
                    <input type="number" id="ordinarySingle" placeholder="300" required>
                </div>
                
                <div class="form-group">
                    <label for="ordinaryDouble">Ordinary Double Price (K)</label>
                    <input type="number" id="ordinaryDouble" placeholder="500" required>
                </div>
                
                <div class="form-group">
                    <label for="eventLineup">Lineup (Optional)</label>
                    <input type="text" id="eventLineup" placeholder="Chingliz, Ba Emma, Smoke">
                </div>
                
                <div class="form-group">
                    <label for="eventTerms">Terms (Optional)</label>
                    <input type="text" id="eventTerms" placeholder="No refunds, 18+ only">
                </div>
                
                <div class="modal-nav">
                    <button type="button" class="btn-prev" onclick="closeAddEventModal()">Cancel</button>
                    <button type="submit" class="btn-pay">Add Event to Sheet</button>
                </div>
            </form>
        </div>
    </div>
    
    <footer>
        NIGHT OF LAUGHTER¬© 2025 ‚Ä¢ All Rights Reserved
    </footer>

    <script>
    // ============================================
    // CONFIGURATION - EDIT THIS SECTION
    // ============================================
    
    // Your SheetDB API URL - Replace with your actual URL
    const SHEETDB_API_URL = "https://sheetdb.io/api/v1/datk69lw1162m";
    
    // Lipila Payment URL
    const LIPILA_PAYMENT_URL = "https://dashboard.lipila.io/pay/?id=89D57F9F154F440";
    
    // Admin password (optional - for admin panel access)
    const ADMIN_PASSWORD = "nol2025"; // Change this to your preferred password

    // ============================================
    // GLOBAL VARIABLES
    // ============================================
    let currentEvent = null;
    let currentStep = 1;
    let ticketData = {
        event: {},
        ticketType: '',
        quantity: 1,
        price: 0,
        customer: {},
        bookingId: '',
        paymentDate: ''
    };

    // ============================================
    // ADMIN PANEL FUNCTIONS
    // ============================================

    function toggleAdminPanel() {
        const panel = document.getElementById('adminPanel');
        const password = prompt("Enter admin password:");
        
        if (password === ADMIN_PASSWORD) {
            panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
        } else if (password !== null) {
            alert("Incorrect password");
        }
    }

    function refreshEvents() {
        document.getElementById('featuredLoader').style.display = 'block';
        document.getElementById('eventsLoader').style.display = 'block';
        
        const featuredSection = document.getElementById("featuredSection");
        const eventsSection = document.getElementById("eventsSection");
        
        featuredSection.innerHTML = '<div class="loader" id="featuredLoader"></div>';
        eventsSection.innerHTML = '<div class="loader" id="eventsLoader"></div>';
        
        fetchEvents();
        alert('Events refreshed successfully!');
    }

    function openAddEventForm() {
        document.getElementById('addEventModal').style.display = 'flex';
        document.getElementById('adminPanel').style.display = 'none';
    }

    function closeAddEventModal() {
        document.getElementById('addEventModal').style.display = 'none';
        document.getElementById('addEventForm').reset();
    }

    function copyApiUrl() {
        const apiUrlInput = document.getElementById('apiUrl');
        apiUrlInput.value = SHEETDB_API_URL;
        apiUrlInput.select();
        apiUrlInput.setSelectionRange(0, 99999);
        navigator.clipboard.writeText(SHEETDB_API_URL);
        alert('API URL copied to clipboard!');
    }

    // Handle Add Event Form Submission
    document.getElementById('addEventForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        // Collect form data
        const eventData = {
            name: document.getElementById('eventName').value,
            type: document.getElementById('eventType').value,
            date: document.getElementById('eventDate').value,
            time: document.getElementById('eventTime').value,
            venue: document.getElementById('eventVenue').value,
            image: document.getElementById('eventImage').value,
            description: document.getElementById('eventDescription').value,
            vip_single: document.getElementById('vipSingle').value || '0',
            vip_double: document.getElementById('vipDouble').value || '0',
            ordinary_single: document.getElementById('ordinarySingle').value || '0',
            ordinary_double: document.getElementById('ordinaryDouble').value || '0',
            lineup: document.getElementById('eventLineup').value || '',
            terms: document.getElementById('eventTerms').value || ''
        };

        try {
            // Show loading state
            const submitBtn = e.target.querySelector('.btn-pay');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Adding...';
            submitBtn.disabled = true;

            // Send data to SheetDB (POST request)
            const response = await fetch(SHEETDB_API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ data: [eventData] })
            });

            if (response.ok) {
                alert('Event added successfully!');
                closeAddEventModal();
                refreshEvents();
            } else {
                const errorData = await response.json();
                alert(`Error adding event: ${errorData.error || 'Please check your SheetDB configuration.'}`);
            }
        } catch (error) {
            console.error('Error:', error);
            alert('Error adding event. Please try again.');
        } finally {
            // Reset button state
            const submitBtn = e.target.querySelector('.btn-pay');
            submitBtn.textContent = 'Add Event to Sheet';
            submitBtn.disabled = false;
        }
    });

    // ============================================
    // HELPER FUNCTIONS
    // ============================================

    // Toggle description
    function toggleDescription(id) {
        const desc = document.getElementById(id);
        if (desc) {
            desc.style.display = (desc.style.display === 'block') ? 'none' : 'block';
        }
    }

    // Format currency
    function formatCurrency(amount) {
        return 'K' + parseInt(amount).toLocaleString();
    }

    // Generate booking ID
    function generateBookingId() {
        return 'NOL-' + Date.now() + '-' + Math.random().toString(36).substr(2, 6).toUpperCase();
    }

    // Show payment status
    function showPaymentStatus(type, message) {
        const banner = document.getElementById('paymentStatusBanner');
        if (type === 'success') {
            banner.innerHTML = `
                <div class="payment-status payment-success">
                    <strong>‚úì ${message}</strong>
                </div>
            `;
        } else {
            banner.innerHTML = `
                <div class="payment-status payment-failed">
                    <strong>‚úó ${message}</strong>
                </div>
            `;
        }
        banner.style.display = 'block';
        
        // Auto-hide after 5 seconds
        setTimeout(() => {
            banner.style.display = 'none';
        }, 5000);
    }

    // ============================================
    // FETCH EVENTS FROM SHEETDB
    // ============================================

    async function fetchEvents() {
        try {
            console.log('Fetching events from SheetDB...');
            
            const response = await fetch(SHEETDB_API_URL);
            
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            
            const data = await response.json();
            console.log('Events fetched:', data);
            
            if (data && data.length > 0) {
                renderEvents(data);
            } else {
                // No data in SheetDB, show empty state
                showEmptyState();
            }
        } catch (error) {
            console.error('Error fetching events:', error);
            showErrorState();
        }
    }

    function showEmptyState() {
        const featuredSection = document.getElementById("featuredSection");
        const eventsSection = document.getElementById("eventsSection");
        
        document.getElementById("featuredLoader").style.display = 'none';
        document.getElementById("eventsLoader").style.display = 'none';
        
        featuredSection.innerHTML = `
            <h2>Featured Events</h2>
            <p style="text-align: center; color: #666; padding: 40px 0;">
                No featured events yet. Use the admin panel (‚öôÔ∏è) to add events.
            </p>
        `;
        
        eventsSection.innerHTML = `
            <h2>Upcoming Events</h2>
            <p style="text-align: center; color: #666; padding: 40px 0;">
                No upcoming events scheduled. Stay tuned!
            </p>
        `;
    }

    function showErrorState() {
        const featuredSection = document.getElementById("featuredSection");
        const eventsSection = document.getElementById("eventsSection");
        
        document.getElementById("featuredLoader").style.display = 'none';
        document.getElementById("eventsLoader").style.display = 'none';
        
        featuredSection.innerHTML = `
            <h2>Featured Events</h2>
            <div style="text-align: center; color: #666; padding: 40px 0;">
                <p>Unable to load events. Please check:</p>
                <p>1. Your SheetDB API URL is correct</p>
                <p>2. Your Google Sheet is publicly accessible</p>
                <p>3. You have internet connection</p>
                <button onclick="refreshEvents()" style="margin-top: 20px; padding: 10px 20px; background: var(--blue); color: white; border: none; border-radius: 5px; cursor: pointer;">
                    Retry
                </button>
            </div>
        `;
        
        eventsSection.innerHTML = '';
    }

    // ============================================
    // EVENT RENDERING
    // ============================================

    // Render event card
    function renderEventCard(ev, idx) {
        const moreId = `desc_${idx}`;
        
        return `<div class="event-card">
            <div class="event-thumb">
                <img src="${ev.image || 'https://via.placeholder.com/400x400?text=Event+Image'}" 
                     loading="lazy" 
                     alt="${ev.name || 'Event'}" 
                     onerror="this.src='https://via.placeholder.com/400x400?text=Event+Image'">
            </div>
            <div class="event-content">
                <div class="event-title">${ev.name || "Event Name"}</div>
                <div><span class="info-label">Date:</span> ${ev.date || "TBA"}</div>
                <div><span class="info-label">Time:</span> ${ev.time || "TBA"}</div>
                <div><span class="info-label">Venue:</span> ${ev.venue || "TBA"}</div>
                <div class="price-box">
                    <div><b>Ticket Prices:</b></div>
                    ${ev.vip_single && ev.vip_single !== '0' ? `<div>VIP Single: K${ev.vip_single}</div>` : ''}
                    ${ev.vip_double && ev.vip_double !== '0' ? `<div>VIP Double: K${ev.vip_double}</div>` : ''}
                    ${ev.ordinary_single && ev.ordinary_single !== '0' ? `<div>Ordinary Single: K${ev.ordinary_single}</div>` : ''}
                    ${ev.ordinary_double && ev.ordinary_double !== '0' ? `<div>Ordinary Double: K${ev.ordinary_double}</div>` : ''}
                </div>
                <div class="btn-row">
                    <button class="btn" onclick="openTicketModal(${JSON.stringify(ev).replace(/"/g, '&quot;').replace(/'/g, "\\'")})">
                        Buy Ticket
                    </button>
                    <button class="btn info" onclick="toggleDescription('${moreId}')">
                        More Info
                    </button>
                </div>
                <div id="${moreId}" style="display:none;margin-top:10px;padding-top:10px;border-top:1px solid #eee;">
                    <p><strong>Description:</strong> ${ev.description || ev.desc || "No description available."}</p>
                    ${ev.lineup ? `<p><strong>Lineup:</strong> ${ev.lineup}</p>` : ''}
                    ${ev.terms ? `<p><strong>Terms:</strong> ${ev.terms}</p>` : ''}
                </div>
            </div>
        </div>`;
    }

    // Render all events
    function renderEvents(eventsData) {
        const featuredSection = document.getElementById("featuredSection");
        const eventsSection = document.getElementById("eventsSection");
        
        // Hide loaders
        document.getElementById("featuredLoader").style.display = 'none';
        document.getElementById("eventsLoader").style.display = 'none';
        
        if (!eventsData || eventsData.length === 0) {
            showEmptyState();
            return;
        }
        
        // Filter featured events
        const featured = eventsData.filter(ev => 
            ev.type && ev.type.toLowerCase().includes('featured')
        );
        
        // Filter upcoming events
        const upcoming = eventsData.filter(ev => 
            !ev.type || !ev.type.toLowerCase().includes('featured')
        );
        
        // Render featured events
        if (featured.length > 0) {
            featuredSection.innerHTML = `
                <h2>Featured Events</h2>
                <div class="event-list">
                    ${featured.map((ev, idx) => renderEventCard(ev, idx)).join('')}
                </div>
            `;
        } else {
            featuredSection.innerHTML = `
                <h2>Featured Events</h2>
                <p style="text-align: center; color: #666; padding: 40px 0;">
                    No featured events at the moment. Check back soon!
                </p>
            `;
        }
        
        // Render upcoming events
        if (upcoming.length > 0) {
            eventsSection.innerHTML = `
                <h2>Upcoming Events</h2>
                <div class="event-list">
                    ${upcoming.map((ev, idx) => renderEventCard(ev, idx)).join('')}
                </div>
            `;
        } else {
            eventsSection.innerHTML = `
                <h2>Upcoming Events</h2>
                <p style="text-align: center; color: #666; padding: 40px 0;">
                    No upcoming events scheduled. Stay tuned for announcements!
                </p>
            `;
        }
    }

    // ============================================
    // TICKET PURCHASE FLOW
    // ============================================

    // Open ticket modal
    function openTicketModal(eventData) {
        currentEvent = eventData;
        ticketData.event = eventData;
        currentStep = 1;
        
        // Reset form
        document.getElementById('ticketType').value = '';
        document.getElementById('ticketQuantity').value = '1';
        document.getElementById('fullName').value = '';
        document.getElementById('email').value = '';
        document.getElementById('phone').value = '';
        
        // Update event name
        document.getElementById('modalEventName').textContent = eventData.name;
        
        // Reset price display
        document.getElementById('priceDisplay').style.display = 'none';
        
        // Show step 1
        showStep(1);
        
        // Open modal
        document.getElementById('ticketModal').style.display = 'flex';
    }

    // Show specific step
    function showStep(step) {
        // Hide all steps
        document.querySelectorAll('.modal-step').forEach(el => {
            el.classList.remove('active');
        });
        
        // Show requested step
        document.getElementById(`step${step}`).classList.add('active');
        currentStep = step;
        
        // Update ticket type price when step 1 is shown
        if (step === 1) {
            setupTicketTypeListeners();
        }
    }

    // Setup ticket type listeners
    function setupTicketTypeListeners() {
        const ticketTypeSelect = document.getElementById('ticketType');
        const quantitySelect = document.getElementById('ticketQuantity');
        const priceDisplay = document.getElementById('priceDisplay');
        const totalPrice = document.getElementById('totalPrice');
        
        function updatePrice() {
            const ticketType = ticketTypeSelect.value;
            const quantity = parseInt(quantitySelect.value);
            
            if (!ticketType || !currentEvent) {
                priceDisplay.style.display = 'none';
                return;
            }
            
            let pricePerTicket = 0;
            switch(ticketType) {
                case 'vip_single':
                    pricePerTicket = parseInt(currentEvent.vip_single) || 0;
                    break;
                case 'vip_double':
                    pricePerTicket = parseInt(currentEvent.vip_double) || 0;
                    break;
                case 'ordinary_single':
                    pricePerTicket = parseInt(currentEvent.ordinary_single) || 0;
                    break;
                case 'ordinary_double':
                    pricePerTicket = parseInt(currentEvent.ordinary_double) || 0;
                    break;
            }
            
            if (pricePerTicket === 0) {
                alert('This ticket type is not available for this event.');
                ticketTypeSelect.value = '';
                priceDisplay.style.display = 'none';
                return;
            }
            
            const total = pricePerTicket * quantity;
            ticketData.price = total;
            ticketData.ticketType = ticketType;
            ticketData.quantity = quantity;
            
            totalPrice.textContent = formatCurrency(total);
            priceDisplay.style.display = 'block';
        }
        
        ticketTypeSelect.addEventListener('change', updatePrice);
        quantitySelect.addEventListener('change', updatePrice);
        
        // Initial price calculation if already selected
        if (ticketTypeSelect.value) {
            updatePrice();
        }
    }

    // Next step
    function nextStep(current) {
        if (current === 1) {
            const ticketType = document.getElementById('ticketType').value;
            const quantity = parseInt(document.getElementById('ticketQuantity').value);
            
            if (!ticketType) {
                alert('Please select a ticket type');
                return;
            }
            
            // Check if ticket price is available
            let pricePerTicket = 0;
            switch(ticketType) {
                case 'vip_single':
                    pricePerTicket = parseInt(currentEvent.vip_single) || 0;
                    break;
                case 'vip_double':
                    pricePerTicket = parseInt(currentEvent.vip_double) || 0;
                    break;
                case 'ordinary_single':
                    pricePerTicket = parseInt(currentEvent.ordinary_single) || 0;
                    break;
                case 'ordinary_double':
                    pricePerTicket = parseInt(currentEvent.ordinary_double) || 0;
                    break;
            }
            
            if (pricePerTicket === 0) {
                alert('This ticket type is not available. Please select another option.');
                return;
            }
            
            if (pricePerTicket * quantity === 0) {
                alert('Please select a valid ticket type and quantity.');
                return;
            }
            
            showStep(2);
        } else if (current === 2) {
            const fullName = document.getElementById('fullName').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            
            if (!fullName) {
                alert('Please enter your full name');
                return;
            }
            
            if (!email) {
                alert('Please enter your email address');
                return;
            }
            
            // Simple email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('Please enter a valid email address');
                return;
            }
            
            if (!phone) {
                alert('Please enter your phone number');
                return;
            }
            
            ticketData.customer = {
                name: fullName,
                email: email,
                phone: phone
            };
            
            updateConfirmation();
            showStep(3);
        }
    }

    // Previous step
    function prevStep(current) {
        showStep(current - 1);
    }

    // Update confirmation display
    function updateConfirmation() {
        document.getElementById('confirmEvent').textContent = currentEvent.name;
        
        let ticketTypeText = '';
        switch(ticketData.ticketType) {
            case 'vip_single': ticketTypeText = 'VIP Single'; break;
            case 'vip_double': ticketTypeText = 'VIP Double'; break;
            case 'ordinary_single': ticketTypeText = 'Ordinary Single'; break;
            case 'ordinary_double': ticketTypeText = 'Ordinary Double'; break;
        }
        
        document.getElementById('confirmTicketType').textContent = ticketTypeText;
        document.getElementById('confirmQuantity').textContent = ticketData.quantity;
        document.getElementById('confirmPrice').textContent = formatCurrency(ticketData.price);
        document.getElementById('confirmName').textContent = ticketData.customer.name;
        document.getElementById('confirmEmail').textContent = ticketData.customer.email;
        document.getElementById('confirmPhone').textContent = ticketData.customer.phone;
    }

    // Proceed to payment
    function proceedToPayment() {
        ticketData.bookingId = generateBookingId();
        ticketData.paymentDate = new Date().toLocaleDateString('en-US', {
            year: 'numeric', month: 'long', day: 'numeric',
            hour: '2-digit', minute: '2-digit'
        });
        
        // Save data for after payment
        localStorage.setItem('lastTicketData', JSON.stringify(ticketData));
        localStorage.setItem('lastEventData', JSON.stringify(currentEvent));
        
        // Create payment data
        const paymentData = {
            amount: ticketData.price,
            event: currentEvent.name,
            ticketType: ticketData.ticketType,
            quantity: ticketData.quantity,
            customerName: ticketData.customer.name,
            customerEmail: ticketData.customer.email,
            customerPhone: ticketData.customer.phone,
            bookingId: ticketData.bookingId
        };
        
        // Redirect to payment gateway
        const encodedData = encodeURIComponent(JSON.stringify(paymentData));
        const callbackUrl = encodeURIComponent(window.location.origin + window.location.pathname + '?payment_callback=true');
        const paymentUrl = `${LIPILA_PAYMENT_URL}&data=${encodedData}&callback=${callbackUrl}`;
        
        closeModal();
        window.location.href = paymentUrl;
    }

    // Check for payment status on page load
    function checkPaymentStatus() {
        const urlParams = new URLSearchParams(window.location.search);
        const paymentCallback = urlParams.get('payment_callback');
        
        if (paymentCallback === 'true') {
            // Simulate payment success (in real implementation, verify with your payment gateway)
            setTimeout(() => {
                showSuccessModal();
                // Clean URL
                window.history.replaceState({}, document.title, window.location.pathname);
            }, 1000);
        }
    }

    // Show success modal with ticket
    function showSuccessModal() {
        const savedTicketData = localStorage.getItem('lastTicketData');
        const savedEventData = localStorage.getItem('lastEventData');
        
        if (savedTicketData && savedEventData) {
            ticketData = JSON.parse(savedTicketData);
            currentEvent = JSON.parse(savedEventData);
            generateTicket();
            document.getElementById('successModal').style.display = 'flex';
            
            // Show payment success banner
            showPaymentStatus('success', 'Payment successful! Your ticket is ready.');
        } else {
            // For demo purposes, create dummy data
            ticketData = {
                event: { name: "ZED Laugh Festival", date: "March 15, 2025", time: "6:00 PM", venue: "Lusaka Playhouse" },
                ticketType: 'vip_single',
                quantity: 1,
                price: 500,
                customer: { name: "Demo User", email: "demo@example.com", phone: "+260-123456789" },
                bookingId: generateBookingId(),
                paymentDate: new Date().toLocaleDateString('en-US', {
                    year: 'numeric', month: 'long', day: 'numeric',
                    hour: '2-digit', minute: '2-digit'
                })
            };
            currentEvent = ticketData.event;
            generateTicket();
            document.getElementById('successModal').style.display = 'flex';
            showPaymentStatus('success', 'Payment successful! Your ticket is ready.');
        }
    }

    // Generate ticket HTML
    function generateTicket() {
        const container = document.getElementById('ticketContainer');
        const qrData = JSON.stringify({
            bookingId: ticketData.bookingId,
            event: ticketData.event.name,
            customer: ticketData.customer.name,
            ticketType: ticketData.ticketType,
            quantity: ticketData.quantity,
            amount: ticketData.price
        });
        
        const ticketHTML = `
            <div class="ticket-template">
                <div class="ticket-header">
                    <h2>NIGHT OF LAUGHTER</h2>
                    <p style="color: #666; margin: 5px 0;">E-Ticket & Receipt</p>
                </div>
                <div class="ticket-body">
                    <div class="ticket-row"><span class="ticket-label">Booking ID:</span><span class="ticket-value">${ticketData.bookingId}</span></div>
                    <div class="ticket-row"><span class="ticket-label">Event:</span><span class="ticket-value">${ticketData.event.name}</span></div>
                    <div class="ticket-row"><span class="ticket-label">Date:</span><span class="ticket-value">${ticketData.event.date}</span></div>
                    <div class="ticket-row"><span class="ticket-label">Time:</span><span class="ticket-value">${ticketData.event.time}</span></div>
                    <div class="ticket-row"><span class="ticket-label">Venue:</span><span class="ticket-value">${ticketData.event.venue}</span></div>
                    <div class="ticket-row"><span class="ticket-label">Ticket Type:</span><span class="ticket-value">${ticketData.ticketType.replace('_', ' ').toUpperCase()}</span></div>
                    <div class="ticket-row"><span class="ticket-label">Quantity:</span><span class="ticket-value">${ticketData.quantity}</span></div>
                    <div class="ticket-row"><span class="ticket-label">Customer:</span><span class="ticket-value">${ticketData.customer.name}</span></div>
                    <div class="ticket-row"><span class="ticket-label">Email:</span><span class="ticket-value">${ticketData.customer.email}</span></div>
                    <div class="ticket-row"><span class="ticket-label">Phone:</span><span class="ticket-value">${ticketData.customer.phone}</span></div>
                    <div class="ticket-row"><span class="ticket-label">Payment Date:</span><span class="ticket-value">${ticketData.paymentDate}</span></div>
                    <div class="ticket-row" style="font-weight: bold; font-size: 1.1em;"><span class="ticket-label">Amount Paid:</span><span class="ticket-value">${formatCurrency(ticketData.price)}</span></div>
                </div>
                <div class="ticket-qr"><div id="qrcode"></div><p style="margin-top: 10px; color: #666; font-size: 14px;">Scan for verification</p></div>
                <div class="ticket-footer"><p>Present this ticket at the entrance</p><p>Terms & Conditions apply ‚Ä¢ No refunds</p></div>
            </div>
        `;
        
        container.innerHTML = ticketHTML;
        
        // Generate QR code
        setTimeout(() => {
            if (typeof QRCode !== 'undefined') {
                new QRCode(document.getElementById("qrcode"), {
                    text: qrData,
                    width: 120,
                    height: 120,
                    colorDark: "#000000",
                    colorLight: "#ffffff",
                    correctLevel: QRCode.CorrectLevel.H
                });
            } else {
                console.error('QRCode library not loaded');
            }
        }, 100);
    }

    // Download ticket as PNG
    function downloadTicket() {
        if (typeof html2canvas === 'undefined') {
            alert('Download feature requires html2canvas library. Please try printing instead.');
            return;
        }
        
        const ticketElement = document.querySelector('.ticket-template');
        html2canvas(ticketElement, { 
            scale: 2, 
            useCORS: true, 
            logging: false,
            backgroundColor: '#ffffff'
        })
        .then(canvas => {
            const link = document.createElement('a');
            link.download = `NOL-Ticket-${ticketData.bookingId}.png`;
            link.href = canvas.toDataURL('image/png');
            link.click();
            showPaymentStatus('success', 'Ticket downloaded successfully!');
        })
        .catch(error => {
            console.error('Error downloading ticket:', error);
            alert('Error downloading ticket. Please try printing instead.');
        });
    }

    // Print ticket
    function printTicket() {
        const ticketElement = document.querySelector('.ticket-template');
        const printWindow = window.open('', '_blank');
        printWindow.document.write(`
            <!DOCTYPE html>
            <html>
            <head>
                <title>Night of Laughter Ticket - ${ticketData.bookingId}</title>
                <style>
                    body { font-family: Arial, sans-serif; padding: 20px; }
                    .ticket { border: 2px solid #333; padding: 20px; max-width: 400px; margin: 0 auto; }
                    .ticket-header { text-align: center; border-bottom: 2px dashed #333; padding-bottom: 15px; margin-bottom: 20px; }
                    .ticket-row { display: flex; justify-content: space-between; margin-bottom: 8px; padding: 8px 0; border-bottom: 1px dashed #ddd; }
                    .ticket-label { font-weight: bold; }
                    @media print { 
                        body { margin: 0; padding: 10px; } 
                        button { display: none; }
                    }
                </style>
            </head>
            <body>
                <div class="ticket">
                    ${ticketElement.innerHTML}
                </div>
                <script>
                    window.onload = function() {
                        window.print();
                        setTimeout(function() { window.close(); }, 1000);
                    }
                </\script>
            </body>
            </html>
        `);
        printWindow.document.close();
    }

    // Close modals
    function closeModal() { 
        document.getElementById('ticketModal').style.display = 'none'; 
        currentEvent = null;
        currentStep = 1;
    }
    
    function closeSuccessModal() { 
        document.getElementById('successModal').style.display = 'none';
        ticketData = { event: {}, ticketType: '', quantity: 1, price: 0, customer: {}, bookingId: '', paymentDate: '' };
        currentEvent = null;
    }

    // ============================================
    // INITIALIZE APPLICATION
    // ============================================

    document.addEventListener('DOMContentLoaded', function() {
        console.log("Page loaded. Initializing...");
        
        // Set API URL in admin panel
        document.getElementById('apiUrl').value = SHEETDB_API_URL;
        
        // Fetch events from SheetDB
        fetchEvents();
        
        // Check for payment status
        checkPaymentStatus();
        
        // Close modals when clicking outside
        window.onclick = function(event) {
            if (event.target === document.getElementById('ticketModal')) closeModal();
            if (event.target === document.getElementById('successModal')) closeSuccessModal();
            if (event.target === document.getElementById('addEventModal')) closeAddEventModal();
        };
        
        // Initialize QR code library
        if (typeof QRCode === 'undefined') {
            console.warn('QRCode library not loaded. Ticket QR codes will not work.');
        }
        
        // Initialize html2canvas
        if (typeof html2canvas === 'undefined') {
            console.warn('html2canvas library not loaded. Ticket downloads will not work.');
        }
    });
    </script>
    
    <!-- html2canvas for ticket download -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</body>
</html>
