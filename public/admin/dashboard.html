<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Dashboard</title>
  <link rel="stylesheet" href="/admin/styles.css">
</head>
<body>
  <div class="header">
    <h1>Dashboard</h1>
    <div>
      <a class="link" href="/admin/events.html">Events</a>
      <a class="link" href="/admin/tickets.html">Tickets</a>
      <a class="link" href="/admin/verify.html">Verify</a>
      <button class="logout" onclick="logout()">Logout</button>
    </div>
  </div>

  <div class="container">
    <div class="grid" id="stats"></div>
  </div>

<script>
if(!localStorage.getItem('admin_token')) location.href='/admin/login.html';

function auth(){ return { 'Authorization':'Bearer '+localStorage.getItem('admin_token') }; }
function logout(){ localStorage.removeItem('admin_token'); location.href='/admin/login.html'; }

async function loadStats(){
  const r = await fetch('/api/admin/stats', { headers: auth() });
  const j = await r.json();
  document.getElementById('stats').innerHTML = `
    <div class="card"><h3>Total Tickets</h3><p>${j.totalTickets}</p></div>
    <div class="card"><h3>Paid Tickets</h3><p>${j.paidTickets}</p></div>
    <div class="card"><h3>Pending</h3><p>${j.pending}</p></div>
    <div class="card"><h3>Revenue (ZMW)</h3><p>K${j.revenue}</p></div>
  `;
}
loadStats();
</script>
</body>
</html>
